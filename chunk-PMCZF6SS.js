import{b as A,e as T,g as z,h as k,i as j,j as B,k as v,l as G,m as R}from"./chunk-VTNYGYCO.js";import{a as S,e as N,g as D}from"./chunk-YLYBOFFV.js";import"./chunk-NJXQSPDU.js";import{Ba as P,Ga as c,La as m,Ma as l,N as O,Oa as u,Ra as _,Sa as C,T as o,Ta as x,Ua as a,Va as s,Wa as h,Ya as y,Za as E,bb as p,db as b,eb as I,fb as w,gb as F,hb as L,ta as r,v as M}from"./chunk-62KPD2B5.js";var g=class i{http=o(S);GetAllEpisodes(t){let e=`${v}/episode/?page=${t}`;return this.http.get(e)}GetEpisodeById(t){let e=`${v}/episode/${t}`;return this.http.get(e)}static \u0275fac=function(e){return new(e||i)};static \u0275prov=O({token:i,factory:i.\u0275fac,providedIn:"root"})};var H=()=>[k,j],U=()=>[import("./chunk-ZDPS4N35.js").then(i=>i.CardsComponent)],W=()=>[import("./chunk-44IDNPUN.js").then(i=>i.NoItemsComponent)];function J(i,t){if(i&1&&(a(0,"option",8),p(1),s()),i&2){let e=E().$implicit;u("value",e),r(),b("Episode - ",e,"")}}function V(i,t){i&1&&(c(0,J,2,2),m(1,0,H),l())}function K(i,t){if(i&1&&h(0,"app-cards",9),i&2){let e=E().$implicit;u("character",e)}}function Q(i,t){i&1&&(c(0,K,1,1),m(1,0,U),l())}function X(i,t){i&1&&h(0,"app-no-items")}function Y(i,t){i&1&&(c(0,X,1,0),m(1,0,W),l())}var $=class i{episodes=[];characters=[];countEpisode=[];page=1;selectedEpisodeId=1;air_date="";episodeName="";episodeNumber="";router=o(D);route=o(N);service=o(g);charactersService=o(G);ngOnInit(){this.route.queryParamMap.subscribe(t=>{let e=t.get("episode");e&&(this.selectedEpisodeId=Number(e)),this.getAllEpisodes(this.page)})}getAllEpisodes(t){this.service.GetAllEpisodes(t).subscribe(e=>{this.episodes=e.results,this.countEpisode=Array.from({length:e.info.count},(n,f)=>f+1),this.selectedEpisodeId&&this.loadCharactersForEpisode(this.selectedEpisodeId)})}loadCharactersForEpisode(t){let e=this.findEpisodeInList(t);e?(this.updateEpisodeInfo(e),this.loadCharacterDetails(e.characters)):this.fetchAndLoadEpisode(t)}findEpisodeInList(t){return this.episodes.find(e=>e.id===t)}updateEpisodeInfo(t){this.episodeName=t.name??"",this.air_date=t.air_date??"",this.episodeNumber=t.episode??""}loadCharacterDetails(t){let e=t.map(n=>this.charactersService.GetCharacterById(this.extractIdFromUrl(n)));M(e).subscribe(n=>{this.characters=n})}fetchAndLoadEpisode(t){this.service.GetEpisodeById(t).subscribe(e=>{e?(this.updateEpisodeInfo(e),this.loadCharacterDetails(e.characters)):console.error("Epis\xF3dio n\xE3o encontrado ou resposta da API inv\xE1lida")})}onEpisodeSelect(t){let e=Number(t.target.value);this.selectedEpisodeId=e,this.router.navigate([],{queryParams:{episode:e},queryParamsHandling:"merge"}),this.loadCharactersForEpisode(e)}extractIdFromUrl(t){let e=t.match(/\/(\d+)$/);return e?Number(e[1]):0}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=P({type:i,selectors:[["app-episode-listing"]],decls:18,vars:5,consts:[[1,"container"],[1,"header"],[1,"content-title"],[1,"description"],[1,"content-search"],["name","episode-number","id","episode-number",3,"change","ngModelChange","ngModel"],["for","episode-number"],[1,"wrapper-cards"],[3,"value"],[3,"character"]],template:function(e,n){e&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),p(4),s(),a(5,"p",3),p(6),s()(),a(7,"div",4)(8,"select",5),y("change",function(d){return n.onEpisodeSelect(d)}),L("ngModelChange",function(d){return F(n.selectedEpisodeId,d)||(n.selectedEpisodeId=d),d}),C(9,V,3,0,null,null,_),s(),a(11,"label",6),p(12,"Search by episode"),s()()(),a(13,"div",7),C(14,Q,3,0,null,null,_,!1,Y,3,0),s()(),h(17,"app-footer")),e&2&&(r(4),b("Episode ",n.episodeName,""),r(2),I("",n.episodeNumber," - ",n.air_date,""),r(2),w("ngModel",n.selectedEpisodeId),r(),x(n.countEpisode),r(5),x(n.characters))},dependencies:[R,B,z,A,T],styles:[".container[_ngcontent-%COMP%]{height:auto;min-height:calc(100dvh - 88px);padding-top:72px;background:var(--background);color:var(--text-title)}.header[_ngcontent-%COMP%]{padding:32px 32px 0;display:flex;align-items:center;justify-content:space-between}.header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.875rem}@media screen and (max-width: 600px){.header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem}}@media screen and (max-width: 468px){.header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.125rem}}.header[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{color:var(--text-body);font-size:.875rem;line-height:1.4285714286;margin-top:2px}@media screen and (max-width: 600px){.header[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:.75rem}}.header[_ngcontent-%COMP%]   .content-search[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.header[_ngcontent-%COMP%]   .content-search[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:120px;padding:8px;color:var(--text-body);font-size:.875rem;border-radius:6px;background:var(--shape);border:1px solid var(--border);-webkit-box-shadow:0px 6px 30px 0px rgba(37,37,41,.6);-moz-box-shadow:0px 6px 30px 0px rgba(37,37,41,.6);box-shadow:0 6px 30px #25252999}.header[_ngcontent-%COMP%]   .content-search[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:1px solid var(--red)}@media screen and (max-width: 468px){.header[_ngcontent-%COMP%]   .content-search[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:.75rem}}.header[_ngcontent-%COMP%]   .content-search[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--text-body);font-weight:400;font-size:.875rem;line-height:1.4285714286}@media screen and (max-width: 468px){.header[_ngcontent-%COMP%]   .content-search[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.75rem}}.wrapper-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(500px,1fr));padding:32px;gap:24px}@media screen and (max-width: 600px){.wrapper-cards[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(200px,1fr))}}@media screen and (max-width: 386px){.wrapper-cards[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(300px,1fr))}}"]})};export{$ as EpisodeListingComponent};
