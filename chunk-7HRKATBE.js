import{a as C,b as S,c as N,d as F,f as E,i as k,k as T,l as z,m as j,n as B}from"./chunk-XRDREU5A.js";import{$ as P,A as v,H as m,K as h,L as g,M as u,N as r,O as c,P as f,R as _,W as d,Y as L,Z as y,_ as M,aa as O,f as x,i as b,l as i,la as I,pa as w,ra as A,w as a}from"./chunk-KGPZSK6B.js";var p=class n{http=i(I);GetAllLocations(t){let e=`${C}/location?page=${t}`;return this.http.get(e)}GetLocationById(t){let e=`${C}/location/${t}`;return this.http.get(e)}static \u0275fac=function(e){return new(e||n)};static \u0275prov=b({token:n,factory:n.\u0275fac,providedIn:"root"})};function R(n,t){if(n&1&&(r(0,"option",6),d(1),c()),n&2){let e=t.$implicit;m("value",e),a(),L("Location - ",e,"")}}function $(n,t){if(n&1&&f(0,"app-cards",9),n&2){let e=t.$implicit;m("character",e)}}var D=class n{locations=[];characters=[];page=1;selectedLocationId=1;countLocation=[];type="";dimension="";locationName="";router=i(A);route=i(w);service=i(p);charactersService=i(S);ngOnInit(){this.route.queryParamMap.subscribe(t=>{let e=t.get("location");e&&(this.selectedLocationId=Number(e)),this.getAllLocations(this.page)})}getAllLocations(t){this.service.GetAllLocations(t).subscribe(e=>{this.locations=e.results,this.countLocation=Array.from({length:e.info.count},(o,l)=>l+1),this.selectedLocationId&&this.loadCharactersForLocation(this.selectedLocationId)})}loadCharacterDetails(t){let e=t.map(o=>this.charactersService.GetCharacterById(this.extractIdFromUrl(o)));x(e).subscribe(o=>{this.characters=o})}loadCharactersForLocation(t){let e=this.findLocationInList(t);e?(this.updateLocationInfo(e),this.loadCharacterDetails(e.residents)):this.fetchAndLoadLocation(t)}onLocationSelect(t){let e=Number(t.target.value);this.selectedLocationId=e,this.router.navigate([],{queryParams:{episode:e},queryParamsHandling:"merge"}),this.loadCharactersForLocation(e)}fetchAndLoadLocation(t){this.service.GetLocationById(t).subscribe(e=>{e?(this.updateLocationInfo(e),this.loadCharacterDetails(e.residents)):console.error("Epis\xF3dio n\xE3o encontrado ou resposta da API inv\xE1lida")})}findLocationInList(t){return this.locations.find(e=>e.id===t)}updateLocationInfo(t){this.locationName=t.name??"",this.dimension=t.dimension??"",this.type=t.type??""}extractIdFromUrl(t){let e=t.match(/\/(\d+)$/);return e?Number(e[1]):0}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=v({type:n,selectors:[["app-location-listing"]],decls:17,vars:4,consts:[[1,"container"],[1,"header"],[1,"content-title"],[1,"description"],[1,"content-search"],["name","location-number","id","location-number",3,"change","ngModelChange","ngModel"],[3,"value"],["for","location-number"],[1,"wrapper-cards"],[3,"character"]],template:function(e,o){e&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),d(4),c(),r(5,"p",3),d(6),c()(),r(7,"div",4)(8,"select",5),_("change",function(s){return o.onLocationSelect(s)}),O("ngModelChange",function(s){return P(o.selectedLocationId,s)||(o.selectedLocationId=s),s}),g(9,R,2,2,"option",6,h),c(),r(11,"label",7),d(12,"Search by location"),c()()(),r(13,"div",8),g(14,$,1,1,"app-cards",9,h),c()(),f(16,"app-footer")),e&2&&(a(4),L("Location ",o.locationName,""),a(2),y("",o.type," - ",o.dimension," "),a(2),M("ngModel",o.selectedLocationId),a(),u(o.countLocation),a(5),u(o.characters))},dependencies:[F,B,z,j,T,E,k,N],styles:[".container[_ngcontent-%COMP%]{height:auto;min-height:calc(100dvh - 88px);padding-top:72px;background:var(--background);color:var(--text-title)}.header[_ngcontent-%COMP%]{padding:32px 32px 0;display:flex;align-items:center;justify-content:space-between}.header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.875rem}@media screen and (max-width: 600px){.header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem}}.header[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{color:var(--text-body);font-size:.875rem;line-height:1.4285714286;margin-top:2px}@media screen and (max-width: 600px){.header[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:.75rem}}.header[_ngcontent-%COMP%]   .content-search[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.header[_ngcontent-%COMP%]   .content-search[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:150px;padding:8px;color:var(--text-body);font-size:.875rem;border-radius:6px;background:var(--shape);border:1px solid var(--border);-webkit-box-shadow:0px 6px 30px 0px rgba(37,37,41,.6);-moz-box-shadow:0px 6px 30px 0px rgba(37,37,41,.6);box-shadow:0 6px 30px #25252999}.header[_ngcontent-%COMP%]   .content-search[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:1px solid var(--red)}.header[_ngcontent-%COMP%]   .content-search[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--text-body);font-weight:400;font-size:.875rem;line-height:1.4285714286}.wrapper-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(500px,1fr));padding:32px;gap:24px}@media screen and (max-width: 600px){.wrapper-cards[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(200px,1fr))}}@media screen and (max-width: 386px){.wrapper-cards[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(300px,1fr))}}"]})};export{D as LocationListingComponent};
