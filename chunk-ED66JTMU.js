import{a as $}from"./chunk-M7KQ3JPD.js";import{b as E,e as T,g as z,h as k,i as j,j as B,k as b,l as G,m as R}from"./chunk-MWJF7WAS.js";import{a as F,e as N,g as D}from"./chunk-2PXOE6WT.js";import"./chunk-GGAWMXZ6.js";import{Ba as O,Ga as h,La as g,Ma as f,N as M,Oa as u,Ra as _,Sa as C,T as i,Ta as L,Ua as r,Va as c,Wa as p,Ya as P,Za as y,bb as d,db as x,eb as I,fb as w,gb as A,hb as S,ta as a,v}from"./chunk-O5P3GJJY.js";var l=class n{http=i(F);GetAllLocations(t){let e=`${b}/location?page=${t}`;return this.http.get(e)}GetLocationById(t){let e=`${b}/location/${t}`;return this.http.get(e)}static \u0275fac=function(e){return new(e||n)};static \u0275prov=M({token:n,factory:n.\u0275fac,providedIn:"root"})};var U=()=>[k,j],W=()=>[import("./chunk-7YXRO5LN.js").then(n=>n.NoItemsComponent)];function J(n,t){if(n&1&&(r(0,"option",9),d(1),c()),n&2){let e=y().$implicit;u("value",e),a(),x("Location - ",e,"")}}function V(n,t){n&1&&(h(0,J,2,2),g(1,0,U),f())}function K(n,t){if(n&1&&p(0,"app-cards",8),n&2){let e=t.$implicit;u("character",e)}}function Q(n,t){n&1&&p(0,"app-no-items")}function X(n,t){n&1&&(h(0,Q,1,0),g(1,0,W),f())}var q=class n{locations=[];characters=[];page=1;selectedLocationId=1;countLocation=[];type="";dimension="";locationName="";router=i(D);route=i(N);service=i(l);charactersService=i(G);ngOnInit(){this.route.queryParamMap.subscribe(t=>{let e=t.get("location");e&&(this.selectedLocationId=Number(e)),this.getAllLocations(this.page)})}getAllLocations(t){this.service.GetAllLocations(t).subscribe(e=>{this.locations=e.results,this.countLocation=Array.from({length:e.info.count},(o,m)=>m+1),this.selectedLocationId&&this.loadCharactersForLocation(this.selectedLocationId)})}loadCharacterDetails(t){let e=t.map(o=>this.charactersService.GetCharacterById(this.extractIdFromUrl(o)));v(e).subscribe(o=>{this.characters=o})}loadCharactersForLocation(t){let e=this.findLocationInList(t);e?(this.updateLocationInfo(e),this.loadCharacterDetails(e.residents)):this.fetchAndLoadLocation(t)}onLocationSelect(t){let e=Number(t.target.value);this.selectedLocationId=e,this.router.navigate([],{queryParams:{episode:e},queryParamsHandling:"merge"}),this.loadCharactersForLocation(e)}fetchAndLoadLocation(t){this.service.GetLocationById(t).subscribe(e=>{e?(this.updateLocationInfo(e),this.loadCharacterDetails(e.residents)):console.error("Epis\xF3dio n\xE3o encontrado ou resposta da API inv\xE1lida")})}findLocationInList(t){return this.locations.find(e=>e.id===t)}updateLocationInfo(t){this.locationName=t.name??"",this.dimension=t.dimension??"",this.type=t.type??""}extractIdFromUrl(t){let e=t.match(/\/(\d+)$/);return e?Number(e[1]):0}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=O({type:n,selectors:[["app-location-listing"]],decls:18,vars:5,consts:[[1,"container"],[1,"header"],[1,"content-title"],[1,"description"],[1,"content-search"],["name","location-number","id","location-number",3,"change","ngModelChange","ngModel"],["for","location-number"],[1,"wrapper-cards"],[3,"character"],[3,"value"]],template:function(e,o){e&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),d(4),c(),r(5,"p",3),d(6),c()(),r(7,"div",4)(8,"select",5),P("change",function(s){return o.onLocationSelect(s)}),S("ngModelChange",function(s){return A(o.selectedLocationId,s)||(o.selectedLocationId=s),s}),C(9,V,3,0,null,null,_),c(),r(11,"label",6),d(12,"Search by location"),c()()(),r(13,"div",7),C(14,K,1,1,"app-cards",8,_,!1,X,3,0),c()(),p(17,"app-footer")),e&2&&(a(4),x("Location ",o.locationName,""),a(2),I("",o.type," - ",o.dimension," "),a(2),w("ngModel",o.selectedLocationId),a(),L(o.countLocation),a(5),L(o.characters))},dependencies:[R,B,z,E,T,$],styles:[".container[_ngcontent-%COMP%]{height:auto;min-height:calc(100dvh - 88px);padding-top:72px;background:var(--background);color:var(--text-title)}.header[_ngcontent-%COMP%]{padding:32px 32px 0;display:flex;align-items:center;justify-content:space-between}.header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.875rem}@media screen and (max-width: 600px){.header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem}}@media screen and (max-width: 468px){.header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.125rem}}.header[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{color:var(--text-body);font-size:.875rem;line-height:1.4285714286;margin-top:2px}@media screen and (max-width: 600px){.header[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:.75rem}}.header[_ngcontent-%COMP%]   .content-search[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.header[_ngcontent-%COMP%]   .content-search[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:150px;padding:8px;color:var(--text-body);font-size:.875rem;border-radius:6px;background:var(--shape);border:1px solid var(--border);-webkit-box-shadow:0px 6px 30px 0px rgba(37,37,41,.6);-moz-box-shadow:0px 6px 30px 0px rgba(37,37,41,.6);box-shadow:0 6px 30px #25252999}.header[_ngcontent-%COMP%]   .content-search[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:1px solid var(--red)}@media screen and (max-width: 600px){.header[_ngcontent-%COMP%]   .content-search[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:120px}}@media screen and (max-width: 468px){.header[_ngcontent-%COMP%]   .content-search[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:.75rem}}.header[_ngcontent-%COMP%]   .content-search[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--text-body);font-weight:400;font-size:.875rem;line-height:1.4285714286}@media screen and (max-width: 468px){.header[_ngcontent-%COMP%]   .content-search[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.75rem}}.wrapper-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(500px,1fr));padding:32px;gap:24px}@media screen and (max-width: 600px){.wrapper-cards[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(200px,1fr))}}@media screen and (max-width: 386px){.wrapper-cards[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(300px,1fr))}}"]})};export{q as LocationListingComponent};
